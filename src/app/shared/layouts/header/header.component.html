<header class="sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm h-16">
  <div class="flex justify-between items-center px-6 h-full">

    <!-- LEFT: Sidebar toggle -->
    <div class="flex items-center gap-4">
      <button
        type="button"
        (click)="toggleSidebar.emit()"
        class="text-gray-600 hover:bg-gray-100 p-2 rounded-md transition"
        matTooltip="Réduire le menu"
      >
        <mat-icon>{{ sidebarCollapsed ? 'menu' : 'menu_open' }}</mat-icon>
      </button>
    </div>

    <!-- RIGHT: Actions -->
    <div class="flex items-center gap-4">

      <!-- Search -->
      <div class="relative hidden md:block">
        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
          <mat-icon class="text-gray-400 text-base">search</mat-icon>
        </div>
        <input
          type="text"
          placeholder="Search..."
          class="pl-10 pr-3 py-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-indigo-100 text-sm w-64 transition"
        >
      </div>

      <!-- Theme Toggle -->
      <button
        type="button"
        (click)="toggleTheme()"
        class="p-2 rounded-full hover:bg-gray-100 text-gray-600 transition"
        matTooltip="Changer le thème"
      >
        <mat-icon>{{ isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
      </button>

      <!-- Notifications -->
      <button
        type="button"
        [matMenuTriggerFor]="notificationsMenu"
        class="p-2 rounded-full hover:bg-gray-100 text-gray-600 transition relative"
        matTooltip="Notifications"
      >
        <mat-icon matBadge="{{ notificationCount() }}" matBadgeColor="warn" matBadgeSize="small">notifications</mat-icon>
      </button>
      <mat-menu #notificationsMenu="matMenu" class="w-80">
        <div class="px-4 py-3 text-sm font-semibold text-gray-700 border-b">Notifications</div>
        <div *ngIf="notifications().length > 0" class="divide-y">
          <a *ngFor="let notification of notifications()"
             href="#"
             class="flex gap-3 px-4 py-3 hover:bg-gray-50 transition">
            <div [ngClass]="getNotificationIconClass(notification.type)"
                 class="flex items-center justify-center w-8 h-8 rounded-full text-white text-sm">
              <mat-icon>{{ getNotificationIcon(notification.type) }}</mat-icon>
            </div>
            <div class="text-sm">
              <div class="text-xs text-gray-400 mb-1">{{ notification.time | date:'short' }}</div>
              <div class="text-gray-800">{{ notification.message }}</div>
            </div>
          </a>
        </div>
        <a href="#" class="block text-center text-sm text-indigo-600 py-2 hover:bg-gray-50">Voir toutes les notifications</a>
      </mat-menu>

      <!-- Profile -->
      <div>
        <button
          class="flex items-center rounded-full overflow-hidden focus:outline-none"
          [matMenuTriggerFor]="profileMenu"
        >
          <img
            class="h-8 w-8 rounded-full border border-gray-200 object-cover"
            [src]="userAvatar"
            alt="Avatar"
          >
        </button>
        <mat-menu #profileMenu="matMenu">
          <div class="px-4 py-3">
            <p class="text-sm text-gray-900 font-medium">{{ userName() }}</p>
            <p class="text-xs text-gray-500 truncate">{{ userEmail() }}</p>
          </div>
          <button mat-menu-item routerLink="/profile">
            <mat-icon>account_circle</mat-icon>
            <span>Mon profil</span>
          </button>
          <button mat-menu-item routerLink="/admin/users">
            <mat-icon>admin_panel_settings</mat-icon>
            <span>Administration</span>
          </button>
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Déconnexion</span>
          </button>
        </mat-menu>
      </div>
    </div>
  </div>
</header>
