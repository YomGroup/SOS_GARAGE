<div class="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 p-4 md:p-6">

  <!-- Gestion des Garages -->
  <div class="content-section" id="garages">
    <div class="container-fluid">
      <!-- En-tête avec statistiques -->
      <div class="stats-cards mb-4">
        <div class="row">
          <div class="col-md-3 mb-3">
            <div class="stats-card">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h3 class="stats-title opacity-90">En attente</h3>
                  <div class="stats-number">{{ stats.enAttente }}</div>
                </div>
                <div class="stats-icon">
                  <i class="fas fa-clock"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="stats-card">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h3 class="stats-title opacity-90">Garages valides</h3>
                  <div class="stats-number">{{ stats.valides }}</div>
                </div>
                <div class="stats-icon">
                  <i class="fas fa-check-circle"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="stats-card">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h3 class="stats-title opacity-90">Rejetés</h3>
                  <div class="stats-number">{{ stats.rejetes }}</div>
                </div>
                <div class="stats-icon">
                  <i class="fas fa-times-circle"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="stats-card">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h3 class="stats-title opacity-90">Total</h3>
                  <div class="stats-number">{{ stats.total }}</div>
                </div>
                <div class="stats-icon">
                  <i class="fas fa-building"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Filtres et recherche -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-3">
              <select class="form-select">
                <option value="">Tous les statuts</option>
                <option value="pending">En attente</option>
                <option value="active">Actif</option>
                <option value="rejected">Rejeté</option>
              </select>
            </div>
            <div class="col-md-3">
              <select class="form-select">
                <option value="">Toutes les régions</option>
                <option value="idf">Île-de-France</option>
                <option value="paca">Provence-Alpes-Côte d'Azur</option>
                <option value="occitanie">Occitanie</option>
              </select>
            </div>
            <div class="col-md-4">
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-search"></i></span>
                <input type="text" class="form-control" placeholder="Rechercher un garage...">
                </div>
            </div>
            <div class="col-md-2">
              <button class="btn btn-primary-custom w-100" (click)="ajouterGarage()">
                <i class="fas fa-plus me-2"></i>Nouveau
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Liste des garages -->
      <div class="garage-list">
        <!-- Tous les garages avec leurs statuts -->
        <div class="garage-card" *ngFor="let reparateur of tousLesGarages">
          <div class="garage-header">
            <div class="garage-title">
              <h4>{{ reparateur.nomDuGarage }}</h4>
              <span class="badge pending" *ngIf="reparateur.isvalids === 'en attente'">En attente</span>
              <span class="badge active" *ngIf="reparateur.isvalids === 'valide'">Valide</span>
              <span class="badge rejected" *ngIf="reparateur.isvalids === 'rejetée'">Rejeté</span>
            </div>
            <div class="garage-actions">
              <!-- Actions pour garages en attente -->
              <button class="btn btn-sm btn-success" title="Valider" 
                      (click)="validerReparateur(reparateur)"
                      *ngIf="reparateur.isvalids === 'en attente'">
                <i class="fas fa-check"></i>
              </button>
              <button class="btn btn-sm btn-danger" title="Rejeter" 
                      (click)="rejeterReparateur(reparateur)"
                      *ngIf="reparateur.isvalids === 'en attente'">
                <i class="fas fa-times"></i>
              </button>
              
              <!-- Actions pour garages validés -->
              <button class="btn btn-sm btn-warning" title="Suspendre"
                      *ngIf="reparateur.isvalids === 'valide'">
                <i class="fas fa-pause"></i>
              </button>
              <button class="btn btn-sm btn-danger" title="Désactiver"
                      *ngIf="reparateur.isvalids === 'valide'">
                <i class="fas fa-ban"></i>
              </button>
              
              <!-- Action commune pour modifier la commission -->
              <button class="btn btn-sm btn-info" title="Modifier la commission" (click)="openCommissionPrompt(reparateur)">
                <i class="fas fa-percent"></i>
              </button>
            </div>
          </div>
          <div class="garage-content">
            <div class="garage-info">
              <div class="info-item">
                <i class="fas fa-map-marker-alt"></i>
                <span>{{ reparateur.adresse }}</span>
              </div>
              <div class="info-item">
                <i class="fas fa-phone"></i>
                <span>{{ reparateur.telephone }}</span>
              </div>
              <div class="info-item">
                <i class="fas fa-envelope"></i>
                <span>{{ reparateur.email }}</span>
              </div>
            </div>
            <div class="garage-details">
              <div class="detail-item">
                <span class="label">SIRET</span>
                <span class="value">{{ reparateur.siret }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Commission</span>
                <span class="value" *ngIf="editedCommissionId !== reparateur.id">{{ reparateur.commission }}%
                  <button class="btn btn-link btn-sm p-0 ms-2" (click)="startEditCommission(reparateur)" title="Modifier">
                    <i class="fas fa-pen"></i>
                  </button>
                </span>
                <span *ngIf="editedCommissionId === reparateur.id">
                  <input type="number" min="0" max="100" [(ngModel)]="editedCommissionValue" style="width:60px;display:inline-block;" /> %
                  <button class="btn btn-success btn-sm ms-1" (click)="saveEditCommission(reparateur)" title="Valider"><i class="fas fa-check"></i></button>
                  <button class="btn btn-secondary btn-sm ms-1" (click)="cancelEditCommission()" title="Annuler"><i class="fas fa-times"></i></button>
                </span>
              </div>
            </div>
          </div>
          <div class="garage-footer">
            <button class="btn btn-outline-primary" (click)="viewDetails(reparateur)">
              <i class="fas fa-eye me-2"></i>Voir détails
            </button>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <nav aria-label="Navigation des garages">
        <ul class="pagination justify-content-center">
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">Précédent</a>
          </li>
          <li class="page-item active"><a class="page-link" href="#">1</a></li>
          <li class="page-item"><a class="page-link" href="#">2</a></li>
          <li class="page-item"><a class="page-link" href="#">3</a></li>
          <li class="page-item">
            <a class="page-link" href="#">Suivant</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
