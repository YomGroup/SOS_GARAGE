<div class="vehicles-page">
  <div class="page-header">
    <button class="btn-primary " (click)="showAddForm = true">
      <i class="icon-plus"></i>
      Ajouter un v√©hicule
    </button>
  </div>

  <!-- Modal Add Vehicle Form -->
  <div class="modal-overlay" *ngIf="showAddForm" (click)="cancelAdd()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Ajouter un nouveau v√©hicule</h2>
        <button class="btn-close" (click)="cancelAdd()">&times;</button>
      </div>
      
      <form (ngSubmit)="addVehicle()" #vehicleForm="ngForm" class="modal-form">
        <div class="form-row">
          <div class="form-group">
            <label>Immatriculation</label>
            <input type="text" [(ngModel)]="newVehicle.immatriculation" (blur)="scrapperVehicules()" 
                   name="immatriculation" required placeholder="Ex: AB-123-CD">
          </div>
          <div *ngIf="scrapErrorMessage" class="error-message">
  {{ scrapErrorMessage }}
</div>

          
          <div class="form-group">
            <label>Marque</label>
            <input type="text" [(ngModel)]="newVehicle.marque" name="marque" required placeholder="Ex: Peugeot">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Mod√®le</label>
            <input type="text" [(ngModel)]="newVehicle.modele" name="model" required placeholder="Ex: 308">
          </div>
          <div class="form-group">
            <label>Cylindr√©e</label>
            <input type="text" [(ngModel)]="newVehicle.cylindree" name="cylindree" required placeholder="Ex: 1.6L">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Carte Grise</label>
            <input type="text" [(ngModel)]="newVehicle.carteGrise" name="carteGrise" required placeholder="Num√©ro carte grise">
          </div>
          <div class="form-group">
            <label>Date de mise en circulation</label>
            <input type="date" [(ngModel)]="newVehicle.dateMiseEnCirculation" name="dateMiseEnCirculation" required>
          </div>
        </div>

        <div class="form-group full-width">
          <label>Contrat d'Assurance</label>
          <input type="text" [(ngModel)]="newVehicle.contratAssurance" name="contratAssurance" required placeholder="Num√©ro de contrat">
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="cancelAdd()">Annuler</button>
          <button type="submit" class="btn-primary" [disabled]="!vehicleForm.valid">Ajouter le v√©hicule</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Vehicles Grid -->
  <div class="vehicles-grid">
    <div class="vehicle-card" *ngFor="let vehicle of vehicles">
      <div class="vehicle-image">
         <img *ngIf="vehicle.imageUrl; else defaultIcon" [src]="vehicle.imageUrl" alt="Image v√©hicule">
    
    <ng-template #defaultIcon>
      <div class="vehicle-icon">üöó</div>
    </ng-template>

    <div class="favorite-btn">‚ô°</div>
      </div>
      <div class="vehicle-content">
        <div class="vehicle-title">{{ vehicle.marque }} {{ vehicle.modele }}</div>
        <div class="vehicle-subtitle">{{ vehicle.dateMiseEnCirculation | date:'yyyy' }}</div>
        
        <div class="vehicle-specs">
          <div class="spec-item">
            <span class="spec-label">Immatriculation</span>
            <span class="spec-value">{{ vehicle.immatriculation }}</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Cylindr√©e</span>
            <span class="spec-value">{{ vehicle.cylindree }}</span>
          </div>
        </div>
        
        <div class="vehicle-footer">
          <div class="vehicle-actions">
            <button class="btn-edit" >
              <span>‚úèÔ∏è</span>
            </button>
            <button class="btn-delete" >
              <span>üóëÔ∏è</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- FULLSCREEN LOADING OVERLAY -->
<div class="fullpage-loader" *ngIf="loadingScrap">
  <div class="spinner-container">
    <div class="spinner-border text-light" role="status"></div>
    <div class="loading-text">Chargement des donn√©es du v√©hicule...</div>
  </div>
</div>
